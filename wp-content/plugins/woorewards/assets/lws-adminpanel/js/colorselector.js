(function(c){c.fn.closeColorSelector=function(){return this.each(function(){if(this._lwsColorSelector!=undefined){this._lwsColorSelector.trigEdited()}}).remove()};function d(){this.updated=null;this.edited=null;this.newColor="#000000";this.oldColor="#000000";this._main=null;this.trigEdited=function(){if(this.edited!=null){this.edited(this.newColor)}};this._html=function(){str="<div id='lwss-color-selector-container' class='lwss-color-selector-relative'>";str+="<div class='lwss-color-selector-dialog'>";str+="<div class='lwss-color-column lwss-color-sliders'>";str+="<div class='lwss-color-line'>";str+="<div class='lwss-color-slide-container lwss-color-slide-xy'>";str+="<div class='lwss-color-slide lwss-color-bg-s'></div>";str+="<div class='lwss-color-slide lwss-color-bg-b'></div>";str+="<div class='lwss-color-cursor lwss-color-cursor-sb'></div>";str+="<div class='lwss-color-slide lwss-color-interact'></div>";str+="</div>";str+="<div class='lwss-color-slide-container lwss-color-slide-y'>";str+="<div class='lwss-color-slide lwss-color-bg-h'></div>";str+="<div class='lwss-color-cursor lwss-color-cursor-h'></div>";str+="<div class='lwss-color-slide lwss-color-interact'></div>";str+="</div></div>";str+="<div class='lwss-color-line'>";str+="<div class='lwss-color-slide-container lwss-color-slide-x'>";str+="<div class='lwss-color-slide lwss-color-damier'></div>";str+="<div class='lwss-color-slide lwss-color-bg-a'></div>";str+="<div class='lwss-color-cursor lwss-color-cursor-a'></div>";str+="<div class='lwss-color-slide lwss-color-interact'></div>";str+="</div>";str+="<div class='lwss-color-slide-container'>";str+="<div class='lwss-color-demo-small lwss-color-damier'></div>";str+="<div class='lwss-color-demo-small lwss-color-demo-next'></div>";str+="</div>";str+="</div>";str+="</div>";str+="<div class='lwss-color-column lwss-color-details' >";str+="<div class='lwss-color-composition'>";str+="<div class='lwss-color-parts lwss-color-hsl'>";str+="<label><div>H</div><input type='text' pattern='(3[0-6]\\d)|([0-2]?\\d?\\d)' data-ref='hsl' data-index='0' size='2'></label>";str+="<label><div>S</div><input type='text' pattern='([01]?\\d?\\d)' data-ref='hsl' data-index='1' size='2'></label>";str+="<label><div>B</div><input type='text' pattern='([01]?\\d?\\d)' data-ref='hsl' data-index='2' size='2'></label>";str+="<label><div>A</div><input type='text' pattern='([01]?\\d?\\d)' data-ref='hsl' data-index='3' size='2'></label>";str+="</div>";str+="<div class='lwss-color-parts lwss-color-rgb'>";str+="<label><div>R</div><input type='text' pattern='(25[0-5])|(2[0-4]\\d)|([01]?\\d?\\d)' data-ref='rgb' data-index='0' size='2'></label>";str+="<label><div>G</div><input type='text' pattern='(25[0-5])|(2[0-4]\\d)|([01]?\\d?\\d)' data-ref='rgb' data-index='1' size='2'></label>";str+="<label><div>B</div><input type='text' pattern='(25[0-5])|(2[0-4]\\d)|([01]?\\d?\\d)' data-ref='rgb' data-index='2' size='2'></label>";str+="<label><div>A</div><input type='text' pattern='(25[0-5])|(2[0-4]\\d)|([01]?\\d?\\d)' data-ref='rgb' data-index='3' size='2'></label>";str+="</div></div>";str+="<div class='lwss-new-color'><input type='text' class='lwss-color-input-next' pattern='((rgba?|hsla?)\\(\\d+(\\.\\d+)?%?(,\\d+(\\.\\d+)?%?)*\\))|(#[0-9a-fA-F]{3,8})' size='8'>";str+="<div tabindex=0 class='lwss-new-color-submit'></div>";str+="</div></div></div></div></div></div>";return str};this.clampRGBA=function(b){for(var a=0;a<b.length;++a){b[a]=Math.max(0,Math.min(255,b[a]))}return b};this.clampHSLA=function(b){b[0]=Math.max(0,Math.min(360,b[0]));for(var a=1;a<b.length;++a){b[a]=Math.max(0,Math.min(100,b[a]))}return b};this.toRGBA=function(v){var h=6*v[0]/360,s=v[1]/100,z=v[2]/100;var i=Math.floor(h),f=h-i,p=z*(1-s),q=z*(1-f*s),t=z*(1-(1-f)*s),a=i%6,r=[z,q,p,p,t,z][a],g=[t,z,z,q,p,p][a],b=[p,p,t,z,z,q][a];return this.clampRGBA([r*255,g*255,b*255,255*v[3]/100])};this.toHSLA=function(p){var u=p[0]/255,r=p[1]/255,h=p[2]/255;var g=Math.max(u,r,h),t=Math.min(u,r,h);var s,a,b=g;var q=g-t;a=g===0?0:q/g;if(g==t){s=0}else{switch(g){case u:s=(r-h)/q+(r<h?6:0);break;case r:s=(h-u)/q+2;break;case h:s=(u-r)/q+4;break}s/=6}return this.clampHSLA([s*360,a*100,b*100,100*p[3]/255])};this.fromColorCursor=function(a,f){var b=a.parent();if(f){return(a.offset().left-b.offset().left)/(b.innerWidth()-a.outerWidth())}else{return(a.offset().top-b.offset().top)/(b.innerHeight()-a.outerHeight())}};this.toColorCursor=function(a,h,g){var b=a.parent();if(h){a.offset({left:((b.innerWidth()-a.outerWidth())*g)+b.offset().left})}else{a.offset({top:((b.innerHeight()-a.outerHeight())*g)+b.offset().top})}};this.moveColorCursor=function(e){var b=c(e.target).parent().find(".lwss-color-cursor");var h=e.pageX-e.target.offsetLeft-(b.outerWidth()/2);var a=e.pageY-e.target.offsetTop-(b.outerHeight()/2);if(b.parent().hasClass("lwss-color-slide-xy")){b.offset({top:a,left:h})}else{if(b.parent().hasClass("lwss-color-slide-x")){b.offset({left:h})}else{if(b.parent().hasClass("lwss-color-slide-y")){b.offset({top:a})}}}};this.colorSelect=function(a){if(a.buttons==1){this.moveColorCursor(a);var b=c(a.target).closest(".lwss-color-sliders");var e=b.find(".lwss-color-cursor-h");var l=b.find(".lwss-color-cursor-sb");var k=b.find(".lwss-color-cursor-a");var h=[360*this.fromColorCursor(e,e.parent().hasClass("lwss-color-slide-x")),100*this.fromColorCursor(l,true),100-(100*this.fromColorCursor(l,false)),100*this.fromColorCursor(k,k.parent().hasClass("lwss-color-slide-x"))];this.applyColor(undefined,this.clampHSLA(h))}};this.litteralColor=function(h,a){var b="";if((Math.abs(h[3]-255)<0.00001)||(a===true)){b="#";for(var g=0;g<3;++g){b+=(h[g]<16?"0":"")+Math.round(h[g]).toString(16)}}else{b="rgba("+Math.round(h[0])+","+Math.round(h[1])+","+Math.round(h[2])+","+(h[3]/255).toFixed(3)+")"}return b};this.applyGradient=function(v,z,p,a,u,x,q,b,w,y){var s=this.litteralColor(this.toRGBA([p,a,u,x]),false);var t=this.litteralColor(this.toRGBA([q,b,w,y]),false);var r="background: -webkit-linear-gradient("+(z?"left,":"top,")+s+","+t+");";r+="background: -o-linear-gradient("+(z?"left,":"top,")+s+","+t+");";r+="background: -moz-linear-gradient("+(z?"left,":"top,")+s+","+t+");";r+="background: linear-gradient("+(z?"to right,":"to bottom,")+s+","+t+");";v.attr("style",r)};this.applyColor=function(h,j){if(h===undefined){h=this.toRGBA(j)}else{if(j===undefined){j=this.toHSLA(h)}}this.newColor=this.litteralColor(h,false);this._main.find("input.lwss-color-input-next").val(this.newColor);this._main.find(".lwss-color-demo-next").css("background",this.newColor);this._main.find(".lwss-color-parts input").each(function(){c(this).val(Math.round((c(this).data("ref")=="rgb"?h:j)[c(this).data("index")]))});var a=this._main.find(".lwss-color-sliders");var b=a.find(".lwss-color-cursor-h");b.css("background-color",this.litteralColor(this.toRGBA([j[0],100,100,100]),true));var l=a.find(".lwss-color-cursor-sb");var k=a.find(".lwss-color-cursor-a");this.toColorCursor(b,b.parent().hasClass("lwss-color-slide-x"),j[0]/360);this.toColorCursor(l,true,j[1]/100);this.toColorCursor(l,false,1-(j[2]/100));this.toColorCursor(k,k.parent().hasClass("lwss-color-slide-x"),j[3]/100);var k=a.find(".lwss-color-bg-a");this.applyGradient(k,k.parent().hasClass("lwss-color-slide-x"),j[0],j[1],j[2],0,j[0],j[1],j[2],100);this.applyGradient(a.find(".lwss-color-bg-s"),true,j[0],0,100,100,j[0],100,100,100);if(this.updated!=null){this.updated(this.newColor)}};this.reset=function(){this.setColor(this.oldColor)};this.composeColor=function(b){var a=[0,0,0,0];b.find("input").each(function(){a[c(this).data("index")]=parseInt(c(this).val())});return a};this.composeFromRGB=function(a){var b=this.composeColor(c(a.target).closest(".lwss-color-parts"));this.applyColor(this.clampRGBA(b),undefined);return false};this.composeFromHSL=function(a){var b=this.composeColor(c(a.target).closest(".lwss-color-parts"));this.applyColor(undefined,this.clampHSLA(b));return false};this.demoShowNew=function(a){c(a.target).css("background",this.newColor)};this.demoShowOld=function(a){c(a.target).css("background",this.oldColor)};this.changeColor=function(a){this.setColor(c(a.target).val(),false)};this.textRgb=function(a){var f=a.match(/\d+(\.\d+)?%?/g);for(var b=0;b<f.length;++b){f[b]=(f[b].endsWith("%")?(255*f[b].split("%")[0]/100):f[b])}if(f.length<4){f.push(1)}f[3]=f[3]*255;return f};this.setColor=function(b,n){try{b=b.trim();var l=[0,0,0,255],m=[0,0,0,100];if(b.length>0){if(b.startsWith("#")){if(b.length>5){l=b.match(/[0-9A-Fa-f]{2}/g)}else{l=b.match(/[0-9A-Fa-f]/g);for(var i=0;i<l.length;++i){l[i]=l[i].concat(l[i])}}for(var i=0;i<l.length;++i){l[i]=parseInt(l[i],16)}if(l.length<4){l.push(255)}m=this.toHSLA(l)}else{if(b.startsWith("hsl")){m=b.match(/\d+(\.\d+)?/g);if(m.length<4){m.push(1)}m[3]=m[3]*100;l=this.toRGBA(m)}else{if(b.startsWith("rgb")){l=this.textRgb(b);m=this.toHSLA(l)}else{try{var a=c("<div />").css("background-color",b);b=window.getComputedStyle(a[0]).backgroundColor}catch(e){}l=this.textRgb(b);m=this.toHSLA(l)}}}}l=this.clampRGBA(l);if(n!=false){this.oldColor=this.litteralColor(l,false)}this.applyColor(l,this.clampHSLA(m))}catch(e){console.log("Invalid value.")}return false};this.show=function(b){if(this.offset!=undefined){this._main=c(this._html()).appendTo(c("body"));this._main.offset({top:(this.offset.top+14),left:this.offset.left})}else{this._main=c(this._html()).appendTo(b)}this._main[0]._lwsColorSelector=this;var a=this;var f=this._main.find("input.lwss-color-input-next");f.change(function(e){a.changeColor(e)});f.keydown(function(e){if((e.keyCode||e.which||e.charCode||0)===9){a._main.find(".lwss-color-composition input:"+(e.shiftKey?"last":"first")).focus();return false}});this._main.find(".lwss-new-color-submit").click(function(){c("#lwss-color-selector-container").closeColorSelector()});this._main.find("input").focus(function(){c(this).select()});this._main.find(".lwss-color-interact").mousedown(function(e){a.colorSelect(e)});this._main.find(".lwss-color-interact").mousemove(function(e){a.colorSelect(e)});this._main.find(".lwss-color-hsl input").change(function(e){a.composeFromHSL(e)});this._main.find(".lwss-color-rgb input").change(function(e){a.composeFromRGB(e)});this._main.find(".lwss-color-demo-small.lwss-color-demo-next").mouseenter(function(e){a.demoShowOld(e)});this._main.find(".lwss-color-demo-small.lwss-color-demo-next").mouseleave(function(e){a.demoShowNew(e)});this._main.find(".lwss-color-demo-small.lwss-color-demo-next").click(function(e){a.reset(e)});this.reset();f.focus()}}c.fn.colorSelector=function(a){if(this.length>0){c("#lwss-color-selector-container").remove();var b=new d();if(a!=undefined){if(a.color!=undefined){b.oldColor=a.color}if(a.updated!=undefined){b.updated=a.updated}if(a.edited!=undefined){b.edited=a.edited}if(a.offset!=undefined){b.offset=a.offset}}b.show(this);return b}return this};c.widget("lws.lwss_colorButton",{options:{color:"",showvalue:true,icon:"lws-icon-lw_dropper",cssColor:"lwss-colorpicker-default-color",property:""},_create:function(){this.wrapper=this.element.addClass("lwss-colorpicker-wrapper");this.shadow=c("<div>").addClass("lwss-colorpicker-shadow").appendTo(this.wrapper);this.left=c("<div>").addClass("lwss-colorpicker-left").appendTo(this.wrapper);this.right=c("<div>").addClass("lwss-colorpicker-right").appendTo(this.wrapper);this.icon=c("<div>").addClass("lwss-colorpicker-icon "+this.options.icon+" "+this.options.cssColor).appendTo(this.left);this.demo=c("<div>").addClass("lwss-colorpicker-demo").appendTo(this.left);this.value=c("<input>").addClass("lwss-colorpicker-value lwss_value").data("css",this.options.property).appendTo(this.right);this.label=c("<div>").addClass("lwss-colorpicker-label").html(this.options.property).appendTo(this.right);this.wrapper.mouseenter(this._bind(this._showShadow,this));this.wrapper.mouseleave(this._bind(this._hideShadow,this));if(this.value.val().length>0){this.options.color=this.value.val()}this._applyColor(this.options.color);var a=this;this.left.click(this._bind(this.open,this));this.value.change(this._bind(this._changeVal,this));this.value.focus(function(){this.select()})},_bind:function(b,a){return function(){return b.apply(a,arguments)}},_showShadow:function(){this.shadow.show()},_hideShadow:function(){this.shadow.hide()},_applyColor:function(a){this.demo.css("background-color",a);this.value.val(a)},_changeVal:function(){this.options.color=this.value.val();this.demo.css("background-color",this.options.color)},open:function(){var f=this;var a=c(this.element).closest(".lwss_editor").find(".lwss-popup-shadow").show();var b={color:f.options.color,edited:function(e){f.color.call(f,e)},offset:this.element.offset()};f.element.colorSelector(b);return false},color:function(a){if(a===undefined){return this.options.color}var b=this.options.color;this.options.color=a;this._applyColor(this.options.color);if(b!=this.options.color){this._trigger("changed",null,this.options.color);this.value.trigger("change")}},_destroy:function(){this.wrapper.remove()}});c.widget("lws.lws_color_picker",{options:{color:"#FFFFFF",title:""},_create:function(){this._setOptions();this._createStructure();this.demo=this.element.find(".lws-cp-demo");this.input=this.element.find(".lws-cp-input");this._applyColor(this.options.color);this.demo.click(this._bind(this.open,this));this.input.change(this._bind(this._changeVal,this));this.input.focus(function(){this.select()})},_bind:function(b,a){return function(){return b.apply(a,arguments)}},_setOptions:function(){if(this.element.data("title")!=undefined){this.options.title=this.element.data("title")}if(this.element.data("color")!=undefined){this.options.color=this.element.data("color")}},_createStructure:function(){c("<div>",{"class":"lws-cp-left"}).append(c("<div>",{"class":"lws-cp-demo"})).appendTo(this.element);c("<div>",{"class":"lws-cp-right"}).append(c("<input>",{"class":"lws-cp-input"})).append(c("<div>",{"class":"lws-cp-title",html:this.options.title})).appendTo(this.element)},_applyColor:function(a){this.demo.css("background-color",a);this.input.val(a)},_changeVal:function(){this.options.color=this.input.val();this.demo.css("background-color",this.options.color)},open:function(){var b=this;var a={color:b.options.color,edited:function(f){b.color.call(b,f)},offset:this.element.offset()};b.element.colorSelector(a);return false},color:function(a){if(a===undefined){return this.options.color}var b=this.options.color;this.options.color=a;this._applyColor(this.options.color);if(b!=this.options.color){this._trigger("changed",null,this.options.color);this.input.trigger("change")}},_destroy:function(){this.element.remove()}});c.fn.colorBtn=function(){return this.each(function(){var a=c(this);var b=a.find(".lwss-btn-color-demo");var g=a.find(".lwss-btn-color-value");var h=a.find("input");a.click(function(){var e={color:g.html(),edited:function(f){b.css("backgroundColor",f);g.html(f);if(h.hasClass("lwss-merge-css")){b.mergeCSS()}else{h.val(f)}}};a.parent().colorSelector(e);return false})})}})(jQuery);jQuery(function(b){b(document).click(function(a){if(b(a.target).closest(".lwss-color-selector-relative").length==0){b("#lwss-color-selector-container").remove()}});b(document).keyup(function(a){if((a.keyCode||a.which||a.charCode||0)===27){b("#lwss-color-selector-container").remove()}else{if((b(a.target).closest(".lwss-color-selector-relative").length>0)&&((a.keyCode||a.which||a.charCode||0)===13)){b("#lwss-color-selector-container").closeColorSelector()}}});b(".lwss-btn-color-selector").colorBtn();b(".lws-color-button").lwss_colorButton();b(".lws-color-picker").lws_color_picker()});