jQuery(function(b){b("#lws_group_title_lws_wr_spending_system").data("flatten",b("#lws_group_title_lws_wr_spending_system").find(".lws-simple-title-text").html()).data("groupBy",b('input[name="lws_wr_levels_title"]').val());b("#lws_group_targetable_lws_wr_spending_system").data("flatten",b("#lws_group_targetable_lws_wr_spending_system").find(".lws-group-descr-help").html()).data("groupBy",b('input[name="lws_wr_levels_help"]').val());b('.lws_editlist.unlockablelist[data-groupby="on"]').each(function(){b("#lws_group_title_lws_wr_spending_system").find(".lws-simple-title-text").html(b("#lws_group_title_lws_wr_spending_system").data("groupBy"));b("#lws_group_targetable_lws_wr_spending_system").find(".lws-group-descr-help").html(b("#lws_group_targetable_lws_wr_spending_system").data("groupBy"))});function a(c){var h=b("#lws-toc-menu");if(h.length==0){return}var i=b(".lws_editlist.unlockablelist");if(i.length==0){return}var j=i.closest(".lws-form-div").attr("id");var g=h.find('.lws-toc-li>a[href$="#'+j+'"]').closest(".lws-toc-li");var d=(g.find("a.active").length>0);g.removeClass("lws-toc-ul-levelling").removeClass("lws-toc-ul-flatten");h.find(".lws-toc-li-l2-"+j).remove();var k=i.find(".lws_editlist_group");if(k.length==0){g.addClass("lws-toc-ul-flatten");if(d){g.find("a:first").addClass("active")}}else{var f=g;k.each(function(m,n){b(n).attr("id",j+"-li"+m);var o=lwsBase64.toObj(b(n).data("line"))["grouped_title"];var l=b("<a>",{href:"#"+j+"-li"+m});l.html((o==undefined||o.trim().length==0)?("level "+(m+1)):o);f=b("<li>",{"class":"lws-toc-li lws-toc-li-l2 lws-toc-li-l2-"+j}).append(l).insertAfter(f)});if(d){if(c!=undefined){var e=b(c.target).closest(".lws_editlist_group").attr("id");g.find('.lws-toc-li>a[href$="'+e+'"]').addClass("active")}else{g.find("a:first").addClass("active")}}}g.children("a").text(b("#lws_group_title_lws_wr_spending_system>.lws-simple-title-text").text())}b(".lws-table-of-content-page-inside").on("change",".lws_editlist_group",a);b(".lws-table-of-content-page-inside").on("group_deleted",".lws_editlist.unlockablelist",a);b(".lws_editlist.unlockablelist").on("grouped",a);b(".lws_editlist.unlockablelist").on("flatten",a);b("#lws-wr-pool-option-type").change(function(){b(".pool_type_exclusive").hide().filter(".pool_type_only_"+b(this).val()).show();var e=b(this).val()=="levelling"?"groupBy":"flatten";var d=b(".lws_editlist.unlockablelist");d.each(function(){b("#lws_group_title_lws_wr_spending_system").find(".lws-simple-title-text").html(b("#lws_group_title_lws_wr_spending_system").data(e));b("#lws_group_targetable_lws_wr_spending_system").find(".lws-group-descr-help").html(b("#lws_group_targetable_lws_wr_spending_system").data(e));b(this).lws_editlist(e)});var c=b("#lws-wr-pool-option-period-mid").closest("tr");if(c.length>0){if(c.prev().find(".lws-field-help")){c.prev().toggle(b(this).val()!="levelling")}c.toggle(b(this).val()!="levelling")}});b("#delete_user_pool").closest("td").css("padding","0");b("#delete_user_pool").parent().click(function(){if(confirm(b('input[name="delete_user_pool_confirm"]').val())){b('input[name="action"]').val("delete");b("#submit").click()}});b("#lws-wr-pool-option-period-begin").change(function(){if(b(this).val().trim()!=""){var f=new Date(b(this).val());var e=b("#lws-wr-pool-option-period-mid");if(e.length>0&&e.val().trim()!=""&&f>(new Date(e.val()))){e.val("")}var c=b("#lws-wr-pool-option-period-end");if(c.length>0&&c.val().trim()!=""&&f>(new Date(c.val()))){c.val("")}}});b("#lws-wr-pool-option-period-mid").change(function(){if(b(this).val().trim()!=""){var f=new Date(b(this).val());var e=b("#lws-wr-pool-option-period-begin");if(e.length>0&&e.val().trim()!=""&&f<(new Date(e.val()))){e.val("")}var c=b("#lws-wr-pool-option-period-end");if(c.length>0&&c.val().trim()!=""&&f>(new Date(c.val()))){c.val("")}}});b("#lws-wr-pool-option-period-end").change(function(){if(b(this).val().trim()!=""){var f=new Date(b(this).val());var e=b("#lws-wr-pool-option-period-begin");if(e.length>0&&e.val().trim()!=""&&f<(new Date(e.val()))){e.val("")}var c=b("#lws-wr-pool-option-period-mid");if(c.length>0&&c.val().trim()!=""&&f<(new Date(c.val()))){c.val("")}}});b("#lws-wr-pools.lws_editlist").on("edit",".lws_editlist_line_form",function(d,f,g){var e=(f.post_id==undefined||f.post_id.toString().trim().length<=0?"create":"save");var i=b(d.target).find("input.lws_wre_pool_save_label."+e).val();b(d.target).find(".lws-editlist-btn-save").html(i).data("action",e);b(d.target).find(".lws_wre_pool_edit_phase_only").hide();b(d.target).find(".lws_wre_pool_edit_phase_only."+e).show();if(e=="create"&&b(d.target).find("input.lws_woorewards_pool_duplic").val().trim().length>0){var h=b(d.target).find("input.lws_woorewards_pool_title");h.val(h.val()+b(d.target).find("input.lws_wre_pool_copy_label").val())}var c=b(d.target).find(".lws_wre_pool_edit_prefabs_value").val();b(d.target).find(".lws_wre_pool_edit_prefabs_only").hide().filter("."+c).show()});b("#lws-wr-pools.lws_editlist").on("change",".lws_wre_pool_edit_lifestyle",function(d){var c=b(d.target).closest(".lws_editlist_line_form").find(".lws_wre_pool_edit_lifestyle_only").hide();if(d.target.checked){c.filter("."+b(d.target).val()).show()}});b("#lws-wr-pools.lws_editlist").on("change",".lws_wre_pool_edit_type",function(d){var c=b(d.target).closest(".lws_editlist_line_form").find(".lws_wre_pool_edit_type_only").hide();c.filter("."+b(d.target).val()).show()});b("#lws-wr-pools.lws_editlist").on("updated",".lws_editlist_row_editable",function(d,e,f){if(e.redirect!=undefined&&e.redirect.length>0){window.location.href=e.redirect}else{var c=b(d.target).find("a.lws_editlist_btn_edit");if(e.edit_url!=undefined&&e.edit_url.length>0){c.attr("href",e.edit_url)}else{c.remove()}}});b("#lws-wr-pools.lws_editlist").on("change",".lws_wre_points_sharing.master",function(e){var d=b(e.target);var c=d.closest(".lws-editlist-fs-table").find(".lws_wre_points_sharing.slave");if(d.val()=="yes"){c.removeClass("fuzzy")}else{c.addClass("fuzzy")}});b(".lws_editlist.unlockablelist").on("edit",function(c,d,e){b("#lws_woorewards_pro_unlockables_role_role_input.lac_select").lac_select("reInitSource")})});